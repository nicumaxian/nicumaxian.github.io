<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Nicu Maxian">
    <meta name="description" content="Nicu Maxian&#39;s null blog">
    <meta name="keywords" content="blog,developer,personal">

    <base href="https://nicumaxian.github.io">
    <title>
  Implementing IsASCII method. Benchmark. · Nicu Maxian - personal blog
</title>

    <link rel="canonical" href="https://nicumaxian.github.io/posts/3-benchmark-simple-isascii/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://nicumaxian.github.io/css/coder.min.da5204b40ef8cbcb52b75a8cac5656a9cebc00a15e25c865a4b84a3c06b3ed82.css" integrity="sha256-2lIEtA74y8tSt1qMrFZWqc68AKFeJchlpLhKPAaz7YI=" crossorigin="anonymous" media="screen" />
    

    

    
      <link rel="stylesheet" href="https://nicumaxian.github.io/css/custom.css">
    

    <link rel="icon" type="image/png" href="https://nicumaxian.github.io/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://nicumaxian.github.io/img/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49.2" />
  </head>

  <body class="">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://nicumaxian.github.io">
      Nicu Maxian - personal blog
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://nicumaxian.github.io/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://nicumaxian.github.io/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Implementing IsASCII method. Benchmark.</h1>
        </div>
        <div class="post-meta">
          <span class="posted-on">
            <i class="far fa-calendar"></i>
            <time datetime='2018-11-01T00:00:00Z'>
              November 1, 2018
            </time>
          </span>
          <span class="reading-time">
            <i class="far fa-clock"></i>
            2 minutes read
          </span>
        </div>
      </header>

      <div>
        

<p>These days I needed a realisation of string ASCII validator. After few google attempts, I found a single constant <code>unicode.MaxASCII</code> in Go SDK, which could help to resolve this problem.
To be sure, I asked on <a href="https://stackoverflow.com/questions/53069040/checking-a-string-contains-only-ascii-characters">stackoverflow</a>.</p>

<p>Since we were discussing about performance, user <a href="https://stackoverflow.com/users/221700/peterso">peterSO</a> did a benchmark, which had a really interesting numbers.
I decided to go forward and create more implementations. Source code can be found <a href="https://github.com/nicumaxian-ellation/benchmarks/tree/master/isascii">here</a>.</p>

<h2 id="implementations">Implementations</h2>

<h3 id="using-go-range">Using Go RANGE</h3>

<p>This method uses a <code>range</code> iteration over a string. It&rsquo;s one of the cleaner solutions in this topic.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">func</span> IsASCIIRange(s <span style="">string</span>) <span style="">bool</span> {
	<span style="font-weight:bold">for</span> _, c := <span style="font-weight:bold">range</span> s {
		<span style="font-weight:bold">if</span> c &gt; unicode.MaxASCII {
			<span style="font-weight:bold">return</span> <span style="font-weight:bold">false</span>
		}
	}

	<span style="font-weight:bold">return</span> <span style="font-weight:bold">true</span>
}</code></pre></div>
<h3 id="using-classic-for-loop">Using classic for-loop</h3>

<p>This is a trivial iteration over string. Which will make a really big difference.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">func</span> IsASCIIClassic(s <span style="">string</span>) <span style="">bool</span> {
	<span style="font-weight:bold">for</span> i := 0; i &lt; len(s); i++ {
		<span style="font-weight:bold">if</span> s[i] &gt; unicode.MaxASCII {
			<span style="font-weight:bold">return</span> <span style="font-weight:bold">false</span>
		}
	}

	<span style="font-weight:bold">return</span> <span style="font-weight:bold">true</span>
}</code></pre></div>
<h3 id="using-regex">Using regex</h3>

<p>Regex. Nothing more to say. Cool, but not always.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">var</span> asciRegex = regexp.MustCompile(<span style="font-style:italic">`^[\x00-\x7F]*$`</span>)

<span style="font-weight:bold">func</span> IsASCIIRegex(s <span style="">string</span>) <span style="">bool</span> {
	<span style="font-weight:bold">return</span> asciRegex.MatchString(s)
}</code></pre></div>
<h3 id="using-rune">Using Rune</h3>

<p>Using <code>strings.IndexFunc</code> we can find first character which satisfy condition of <code>unicode</code>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">func</span> IsASCIIRune(s <span style="">string</span>) <span style="">bool</span> {
	nonASCIIChar := <span style="font-weight:bold">func</span>(r <span style="">rune</span>) <span style="">bool</span> {
		<span style="font-weight:bold">return</span> r &gt; unicode.MaxASCII
	}

	<span style="font-weight:bold">return</span> strings.IndexFunc(s, nonASCIIChar) == -1
}</code></pre></div>
<h2 id="benchmark">Benchmark</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">goos: darwin
goarch: amd64
pkg: github.com/nicumaxian-ellation/benchmarks/isascii
BenchmarkIsASCIIRange-8     	50000000	        35.8 ns/op
BenchmarkIsASCIIClassic-8   	100000000	        19.2 ns/op
BenchmarkIsASCIIRegex-8     	 2000000	       987 ns/op
BenchmarkIsASCIIRune-8      	20000000	       104 ns/op
PASS
ok  	github.com/nicumaxian-ellation/benchmarks/isascii	8.965s</code></pre></div>
<h2 id="conclusion">Conclusion</h2>

<p>We didn&rsquo;t usually thing on such small things. Actually, small things matters. There is a big performance difference between <code>Range</code> and <code>classic for</code> solutions.
The diff between these two is <code>~1.86%</code>. Which as you see, is quite big.</p>

<p>If you&rsquo;re working with a big amount of data, than you obviously should consider it.
For a small amount of data, I would choose cleanest solution. For me it was solution #1 (<code>using range</code>).</p>

      </div>

      <footer>
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
     © 2018
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
